<div class="container-single-view">
  <div class="back-button" [routerLink]="['/talentbase']">
    <mat-icon class="icon-fz16">keyboard_arrow_left</mat-icon>
    Back to TalentDB
  </div>

  <!-- MAIN CONTENT START -->

  <div class="single-view__main-content">

    <!-- LEFT BLOCK START -->
    <div class="single-view__left-block" *ngIf="leftBlockInfo">
        <div class="single-view__candidate-main-info">
          <div *ngIf="!leftBlockInfo.user.avatarURL" class="single-view__candidate-main-info_no-avatar">
            <span>{{leftBlockInfo.user.firstName.charAt(0)}}&nbsp;{{leftBlockInfo.user.lastName.charAt(0)}}</span>
          </div>
          <img *ngIf="leftBlockInfo.user.avatarURL" src="{{leftBlockInfo.user.avatarURL}}" alt="" class="single-view__candidate-main-info_avatar">
          <span class="single-view__candidate-main-info_name">{{leftBlockInfo.user.firstName}}&nbsp;{{leftBlockInfo.user.lastName}}</span>
          <span class="single-view__candidate-main-info_headline">{{leftBlockInfo.user.headline}}</span>
        </div>
        <div class="single-view__candidate-contact-info">
          <span class="single-view__candidate-contact-info_info" *ngIf="leftBlockInfo.user.email">
            Email adress: <a href="mailto:{{leftBlockInfo.user.email}}">{{leftBlockInfo.user.email}}</a>
          </span>
          <span *ngIf="leftBlockInfo.user.Phone">Phone 1: {{leftBlockInfo.user.Phone}}</span>
          <span *ngIf="leftBlockInfo.user.phone2">Phone 2: {{leftBlockInfo.user.phone2}}</span>
        </div>
        <div class="single-view__candidate-websites-info" *ngIf="leftBlockInfo.user.WebSites">
          <span class="single-view__candidate-websites-info_website" *ngFor="let website of leftBlockInfo.user.WebSites">
            <span *ngIf="website.Url !== ''">
              <span>{{website.Type}}:&nbsp;</span>
              <span>
                <a href="{{website.Url}}" target="_blank">{{website.Url}}</a>
              </span>
            </span>
          </span>
        </div>
        <div class="single-view__candidate-attachments">
          <span class="single-view__candidate-tags_title">Attachments</span>
          <span class="single-view__candidate-attachments_attachment-name">References.doc <mat-icon class="icon-fz14">cancel</mat-icon> </span>
          <mat-icon class="single-view__candidate-attachments_add-file">add_box</mat-icon>
        </div>
        <div class="single-view__candidate-attachments">
          <span class="single-view__candidate-tags_title">CV</span>
          <span class="single-view__candidate-attachments_attachment-name">MartinCV.doc <mat-icon class="icon-fz14">cancel</mat-icon> </span>
          <mat-icon class="single-view__candidate-attachments_add-file">add_box</mat-icon>
        </div>
        <div class="single-view__candidate-tags">
          <p class="single-view__candidate-tags_holder">
            <span class="single-view__candidate-tags_title">Tags</span>
            <input type="text" placeholder="Add tag" (keydown.enter)="addTag($event.target.value)">
          </p>
          <span *ngIf="leftBlockInfo.tags.length === 0">
            This candidate doesn't have any tags.
          </span>
          <span *ngIf="leftBlockInfo.tags.length > 0">
            <span class="single-view__candidate-tags_tag" *ngFor="let tag of leftBlockInfo.tags">#{{tag.tagName}}</span>
          </span>
        </div>
        <div class="single-view__candidate-edit">
          <div class="single-view__candidate-edit_buttons">
            <mat-icon matTooltip="Email Candidate" matTooltipPosition="above">mail_outline</mat-icon>
            <mat-icon class="reject-icon" matTooltip="Reject Candidate" matTooltipPosition="above">cancel</mat-icon>
            <mat-icon class="move-icon" matTooltip="Move To Stage" matTooltipPosition="above">zoom_out_map</mat-icon>
            <mat-icon matTooltip="Copy To Job" matTooltipPosition="above">file_copy</mat-icon>
            <mat-icon matTooltip="Delete Candidate" matTooltipPosition="above">delete_outline</mat-icon>
          </div>
          <p class="single-view__candidate-edit_button">
            Edit contact info
          </p>
        </div>
    </div>
    <!-- LEFT BLOCK END -->

    <!-- CENTER BLOCK START -->

    <div class="single-view__center-block">
       <div class="single-view__center-block_no-info" *ngIf="centerBlockInfo.length === 0">
         <p class="single-view__center-block_no-info__title" *ngIf="leftBlockInfo && currentUser">{{leftBlockInfo.user.firstName}} & {{currentUser.get('Client')}}</p>
         <p class="single-view__center-block_no-info__description">
           You can follow here your relationship with this candidate throughout time.
         </p>
         <p class="single-view__center-block_no-info__description--bold">
          Jobs he applied, current stage on the hiring cycle, previous rejections etc...
        </p>
       </div>
       <div class="single-view__center-block_info" *ngIf="centerBlockInfo.length > 0">
        <table>
          <tr [ngClass]="{'active': currentPipelineStage === stage, 'dn': stage.contracts.length === 0}" 
              *ngFor="let stage of centerBlockInfo"
              (click)="setCurrentPipelineStage(stage)">
            <td>{{stage.title}}</td>
            <td>{{stage.count}}</td>
          </tr>
        </table>
        <div *ngIf="currentPipelineStage">
          <div class="single-view__center-contract-box" *ngFor="let contract of currentPipelineStage.contracts">
            <p class="single-view__center-contract-box--title">{{contract.contractTitle}}</p>
            <p class="single-view__center-contract-box--item">
              <span *ngIf="currentPipelineStage.title === 'Applied'">Applied on</span>
              <span *ngIf="currentPipelineStage.title === 'Rejected'">Rejected on</span>
              <span *ngIf="currentPipelineStage.title !== 'Rejected' && currentPipelineStage.title !== 'Applied'">Was moved to {{currentPipelineStage.title}} stage on</span>
              {{contract._created_at | date: "MM/dd/yyyy"}}
            </p>
            <p *ngIf="contract.jobLocation" class="single-view__center-contract-box--item">
              Location:
              <span>{{contract.jobLocation}}</span>
              <span *ngIf="contract.jobLocation2">, {{contract.jobLocation2}}</span>
              <span *ngIf="contract.jobLocation3">, {{contract.jobLocation3}}</span>
            </p>
            <p class="single-view__center-contract-box--item" *ngIf="contract.CandidateSourceName">Source: {{contract.CandidateSourceName}}</p>
            <p class="single-view__center-contract-box--item" *ngIf="currentPipelineStage.title === 'Rejected'">Reason: {{contract.reason}}</p>
            <p class="single-view__center-contract-box--item" *ngIf="currentPipelineStage.title === 'Rejected' && currentPipelineStage.rejectionNote">Rejected note: {{contract.rejectionNote}}</p>
          </div>
        </div>
       </div>
    </div>

    <!-- CENTER BLOCK END -->


  </div>

  <!-- MAIN CONTENT END -->

</div>
